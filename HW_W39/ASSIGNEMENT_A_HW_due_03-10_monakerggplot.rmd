---
title: "W39 Visualization of the duration of reign among Danish monarchs through time"
author: "Hans Hermann"
date: "29/9/2023"
output: html_document
---

## Get the necessary packages

I have installed the relevant package 'tidyverse' now applying:

```{r libraries}
library(tidyverse)
library(ggplot2)
```

## Task A

Visualize the duration of reign among Danish kings through time (showing the diachronic trend from ca 900 - today on the x axis) with ggplot. Use the dataset you/your group has created and submit both the script and the visualisation, ideally as part of an rmarkdown and html document (for details see bottom of this page). Experiment with geom_point(), geom_line() or geom_smooth() functions for the geometry.

## My solution

First i create a tibble from the dataset I have created from the earlier homework

```{r }
monarker <- read_csv2("data/HW2_due19-09_2_tidyversion.csv")
monarker
```

I have already created a column in excel that I have called "Regeringstid", by subtracting regent_til with regent_fra in all the rows.

If I hadn't done that, i could create the column by using the mutate() function:

```{r}
# monarker %>% 
#   mutate(regeringstid = regent_til - regent_fra)

```

Now for creating the visualization:

(I made a column in excel called "nr_monark" with values corresponding to the monarchs' number in time, because I couldn't figure out how to create it in R.)

```{r}

monarker %>%
  ggplot(aes(x = reorder(monark, +nr_monark), y = regeringstid)) +
  geom_bar(stat = "identity") +
  stat_smooth(method = "lm", se = FALSE, color = "blue") +
  labs(title = "Duration of reign among Danish monarchs through time",
       x = "Monarch",
       y = "Years ruled") +
  theme_bw() +
  theme(axis.text.x = element_text(size = 7.5, angle = 90, hjust = 1, vjust = 0.3),
        axis.text.y = element_text(colour = "grey20", size = 12),
        text = element_text(size = 14))

```

This is the code that I could figure out. the "stat_smooth(method ="lm", se = FALSE, color = "blue")" line is what i could read about on resources online that should create a trendline, however, it doesn't show up, and i get a message: "[38;5;232m`geom_smooth()` using formula = 'y \~ x'[39m". From what I can gather, the code should work, and maybe there is an issue in my installation. Eventually, i got expert help and wrote the following code, but it is a bit above my head, so I can't really explain how it works / what it does exactly.

```{r}
monarker$order <- 1:nrow(monarker)

monarker$monark_ordered <- factor(monarker$monark, levels = unique(monarker$monark), ordered = TRUE)

monarker %>%
  ggplot(aes(x = monark_ordered, y = regeringstid)) +
  geom_bar(stat = "identity") +
  stat_smooth(aes(x = as.numeric(monark_ordered)), method = "lm", se = FALSE, color = "blue") +
  labs(title = "Duration of reign among Danish monarchs through time",
       x = "Monarch",
       y = "Years ruled") +
  theme_bw() +
  theme(axis.text.x = element_text(size = 7.5, angle = 90, hjust = 1, vjust = 0.3),
        axis.text.y = element_text(colour = "grey20", size = 12),
        text = element_text(size = 14))

```

The trend line indicates that there is a trend towards monarchs reigning for longer.
